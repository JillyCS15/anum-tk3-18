clc; clear; close all
#source https://www.youtube.com/watch?v=UDYlLJVvsxI

f=@(x) 97.02 + 2.219*(x-1960)+0.03045*(x-1960)*(x-1970)-0.000413*(x-1960)*(x-1970)*(x-1980)-0.000025583*(x-1960)*(x-1970)*(x-1980)*(x-1990)+0.00000202167*(x-1960)*(x-1970)*(x-1980)*(x-1990)*(x-2000)	- 0.000000076625*(x-1960)*(x-1970)*(x-1980)*(x-1990)*(x-2000)*(x-2010)- 0.000000001849007937*(x-1960)*(x-1970)*(x-1980)*(x-1990)*(x-2000)*(x-2010)*(x-2020);

a =1960;
b= 2020;
n = 6;
h =b-a;
r = zeros(2, n+1);
r(1,1) = (f(a) + f(b))/2*h;
fprintf('\n %11.4f\n', r(1,1));

for i=2:n
  sum=0;
  for k =1:2^(i-2);
    sum = sum+f(a+(k-0.5)*h);
  endfor
  r(2,1) = (r(1,1)+h*sum)/2;
  
  for j=2:i
    l = 2^(2*(j-1));
    r(2,j) = r(2,j-1) + (r(2,j-1)-r(1,j-1))/(l-1);
  endfor
  
  for k =1:i
    fprintf(' %11.4f', r(2,k));
  endfor
  
  fprintf('\n');
  h=h/2;
  for j=1:i
    r(1,j) = r(2,j);
    
  endfor
endfor
